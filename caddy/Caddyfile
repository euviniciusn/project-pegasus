{
	auto_https off
}

:80 {
	# ── API reverse proxy ──
	handle /api/* {
		reverse_proxy api:3000
	}

	# ── MinIO presigned URLs proxy ──
	handle /storage/* {
		uri strip_prefix /storage
		reverse_proxy minio:9000 {
			header_up Host minio:9000
		}
	}

	# ── Health check ──
	handle /health {
		respond "OK" 200
	}

	# ── Frontend ──
	handle {
		reverse_proxy frontend:80
	}
}
